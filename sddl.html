<!DOCTYPE html>
<!--
 * Copyright (c) 2016 Mountainstorm
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 -->
 <html lang="en">
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    </head>

    <style>
        .hdr-bg {
            background: #785643;
        }

        .header {
            color: white;    
        }

        .body > .row {
            margin-top: 20px;
        }

        textarea {
            max-width: 100%;
            min-width: 100%;
            width: 100%;
        }

        table > tbody > tr > *:first-child {
            vertical-align: top;
        }

        table > tbody > tr > *:last-child {
            padding-left: 5px;
        }

        table {
            border: 1px solid lightgray;
            border-width: 1px 0px 0px 0px;
            margin: 5px 0px 5px 0px;
        }

.color0 { background-color: #000000; color: #ffffff;  }
.color1 { background-color: #FFFF00; color: #000000;  }
.color2 { background-color: #1CE6FF; color: #000000;  }
.color3 { background-color: #FF34FF; color: #000000;  }
.color4 { background-color: #FF4A46; color: #000000;  }
.color5 { background-color: #008941; color: #000000;  }
.color6 { background-color: #006FA6; color: #000000;  }
.color7 { background-color: #A30059; color: #ffffff;  }
.color8 { background-color: #FFDBE5; color: #000000;  }
.color9 { background-color: #7A4900; color: #ffffff;  }
.color10 { background-color: #0000A6; color: #ffffff;  }
.color11 { background-color: #63FFAC; color: #000000;  }
.color12 { background-color: #B79762; color: #000000;  }
.color13 { background-color: #004D43; color: #ffffff;  }
.color14 { background-color: #8FB0FF; color: #000000;  }
.color15 { background-color: #997D87; color: #000000;  }
.color16 { background-color: #5A0007; color: #000000;  }
.color17 { background-color: #809693; color: #000000;  }
.color18 { background-color: #FEFFE6; color: #000000;  }
.color19 { background-color: #1B4400; color: #ffffff;  }
.color20 { background-color: #4FC601; color: #000000;  }
.color21 { background-color: #3B5DFF; color: #000000;  }
.color22 { background-color: #4A3B53; color: #ffffff;  }
.color23 { background-color: #FF2F80; color: #000000;  }
.color24 { background-color: #61615A; color: #000000;  }
.color25 { background-color: #BA0900; color: #000000;  }
.color26 { background-color: #6B7900; color: #000000;  }
.color27 { background-color: #00C2A0; color: #000000;  }
.color28 { background-color: #FFAA92; color: #000000;  }
.color29 { background-color: #FF90C9; color: #000000;  }
.color30 { background-color: #B903AA; color: #000000;  }
.color31 { background-color: #D16100; color: #000000;  }
.color32 { background-color: #DDEFFF; color: #000000;  }
.color33 { background-color: #000035; color: #ffffff;  }
.color34 { background-color: #7B4F4B; color: #ffffff;  }
.color35 { background-color: #A1C299; color: #000000;  }
.color36 { background-color: #300018; color: #ffffff;  }
.color37 { background-color: #0AA6D8; color: #000000;  }
.color38 { background-color: #013349; color: #000000;  }
.color39 { background-color: #00846F; color: #ffffff;  }
.color40 { background-color: #372101; color: #ffffff;  }
.color41 { background-color: #FFB500; color: #000000;  }
.color42 { background-color: #C2FFED; color: #000000;  }
.color43 { background-color: #A079BF; color: #000000;  }
.color44 { background-color: #CC0744; color: #000000;  }
.color45 { background-color: #C0B9B2; color: #000000;  }
.color46 { background-color: #C2FF99; color: #000000;  }
.color47 { background-color: #001E09; color: #ffffff;  }
.color48 { background-color: #00489C; color: #ffffff;  }
.color49 { background-color: #6F0062; color: #ffffff;  }
.color50 { background-color: #0CBD66; color: #000000;  }
.color51 { background-color: #EEC3FF; color: #000000;  }
.color52 { background-color: #456D75; color: #000000;  }
.color53 { background-color: #B77B68; color: #000000;  }
.color54 { background-color: #7A87A1; color: #000000;  }
.color55 { background-color: #788D66; color: #000000;  }
.color56 { background-color: #885578; color: #000000;  }
.color57 { background-color: #FAD09F; color: #000000;  }
.color58 { background-color: #FF8A9A; color: #000000;  }
.color59 { background-color: #D157A0; color: #000000;  }
.color60 { background-color: #BEC459; color: #000000;  }
.color61 { background-color: #456648; color: #ffffff;  }
.color62 { background-color: #0086ED; color: #000000;  }
.color63 { background-color: #886F4C; color: #000000;  }
.color64 { background-color: #34362D; color: #ffffff;  }
.color65 { background-color: #B4A8BD; color: #000000;  }
.color66 { background-color: #00A6AA; color: #000000;  }
.color67 { background-color: #452C2C; color: #ffffff;  }
.color68 { background-color: #636375; color: #ffffff;  }
.color69 { background-color: #A3C8C9; color: #000000;  }
.color70 { background-color: #FF913F; color: #000000;  }
.color71 { background-color: #938A81; color: #000000;  }
.color72 { background-color: #575329; color: #ffffff;  }
.color73 { background-color: #00FECF; color: #000000;  }
.color74 { background-color: #B05B6F; color: #000000;  }
.color75 { background-color: #8CD0FF; color: #000000;  }
.color76 { background-color: #3B9700; color: #000000;  }
.color77 { background-color: #04F757; color: #000000;  }
.color78 { background-color: #C8A1A1; color: #000000;  }
.color79 { background-color: #1E6E00; color: #ffffff;  }
.color80 { background-color: #7900D7; color: #ffffff;  }
.color81 { background-color: #A77500; color: #000000;  }
.color82 { background-color: #6367A9; color: #000000;  }
.color83 { background-color: #A05837; color: #000000;  }
.color84 { background-color: #6B002C; color: #ffffff;  }
.color85 { background-color: #772600; color: #ffffff;  }
.color86 { background-color: #D790FF; color: #000000;  }
.color87 { background-color: #9B9700; color: #000000;  }
.color88 { background-color: #549E79; color: #000000;  }
.color89 { background-color: #FFF69F; color: #000000;  }
.color90 { background-color: #201625; color: #000000;  }
.color91 { background-color: #72418F; color: #000000;  }
.color92 { background-color: #BC23FF; color: #000000;  }
.color93 { background-color: #99ADC0; color: #000000;  }
.color94 { background-color: #3A2465; color: #000000;  }
.color95 { background-color: #922329; color: #000000;  }
.color96 { background-color: #5B4534; color: #000000;  }
.color97 { background-color: #FDE8DC; color: #000000;  }
.color98 { background-color: #404E55; color: #000000;  }
.color99 { background-color: #0089A3; color: #000000;  }
.color100 { background-color: #CB7E98; color: #000000;  }
.color101 { background-color: #A4E804; color: #000000;  }
.color102 { background-color: #324E72; color: #000000;  }
.color103 { background-color: #6A3A4C; color: #000000;  }
.color104 { background-color: #83AB58; color: #000000;  }
.color105 { background-color: #001C1E; color: #000000;  }
.color106 { background-color: #D1F7CE; color: #000000;  }
.color107 { background-color: #004B28; color: #000000;  }
.color108 { background-color: #C8D0F6; color: #000000;  }
.color109 { background-color: #A3A489; color: #000000;  }
.color110 { background-color: #806C66; color: #000000;  }
.color111 { background-color: #222800; color: #000000;  }
.color112 { background-color: #BF5650; color: #000000;  }
.color113 { background-color: #E83000; color: #000000;  }
.color114 { background-color: #66796D; color: #000000;  }
.color115 { background-color: #DA007C; color: #000000;  }
.color116 { background-color: #FF1A59; color: #000000;  }
.color117 { background-color: #8ADBB4; color: #000000;  }
.color118 { background-color: #1E0200; color: #000000;  }
.color119 { background-color: #5B4E51; color: #000000;  }
.color120 { background-color: #C895C5; color: #000000;  }
.color121 { background-color: #320033; color: #000000;  }
.color122 { background-color: #FF6832; color: #000000;  }
.color123 { background-color: #66E1D3; color: #000000;  }
.color124 { background-color: #CFCDAC; color: #000000;  }
.color125 { background-color: #D0AC94; color: #000000;  }
.color126 { background-color: #7ED379; color: #000000;  }
.color127 { background-color: #012C58; color: #000000;  }
.color128 { background-color: #7A7BFF; color: #000000;  }
.color129 { background-color: #D68E01; color: #000000;  }
.color130 { background-color: #353339; color: #000000;  }
.color131 { background-color: #78AFA1; color: #000000;  }
.color132 { background-color: #FEB2C6; color: #000000;  }
.color133 { background-color: #75797C; color: #000000;  }
.color134 { background-color: #837393; color: #000000;  }
.color135 { background-color: #943A4D; color: #000000;  }
.color136 { background-color: #B5F4FF; color: #000000;  }
.color137 { background-color: #D2DCD5; color: #000000;  }
.color138 { background-color: #9556BD; color: #000000;  }
.color139 { background-color: #6A714A; color: #000000;  }
.color140 { background-color: #001325; color: #000000;  }
.color141 { background-color: #02525F; color: #000000;  }
.color142 { background-color: #0AA3F7; color: #000000;  }
.color143 { background-color: #E98176; color: #000000;  }
.color144 { background-color: #DBD5DD; color: #000000;  }
.color145 { background-color: #5EBCD1; color: #000000;  }
.color146 { background-color: #3D4F44; color: #000000;  }
.color147 { background-color: #7E6405; color: #000000;  }
.color148 { background-color: #02684E; color: #000000;  }
.color149 { background-color: #962B75; color: #000000;  }
.color150 { background-color: #8D8546; color: #000000;  }
.color151 { background-color: #9695C5; color: #000000;  }
.color152 { background-color: #E773CE; color: #000000;  }
.color153 { background-color: #D86A78; color: #000000;  }
.color154 { background-color: #3E89BE; color: #000000;  }
.color155 { background-color: #CA834E; color: #000000;  }
.color156 { background-color: #518A87; color: #000000;  }
.color157 { background-color: #5B113C; color: #000000;  }
.color158 { background-color: #55813B; color: #000000;  }
.color159 { background-color: #E704C4; color: #000000;  }
.color160 { background-color: #00005F; color: #000000;  }
.color161 { background-color: #A97399; color: #000000;  }
.color162 { background-color: #4B8160; color: #000000;  }
.color163 { background-color: #59738A; color: #000000;  }
.color164 { background-color: #FF5DA7; color: #000000;  }
.color165 { background-color: #F7C9BF; color: #000000;  }
.color166 { background-color: #643127; color: #000000;  }
.color167 { background-color: #513A01; color: #000000;  }
.color168 { background-color: #6B94AA; color: #000000;  }
.color169 { background-color: #51A058; color: #000000;  }
.color170 { background-color: #A45B02; color: #000000;  }
.color171 { background-color: #1D1702; color: #000000;  }
.color172 { background-color: #E20027; color: #000000;  }
.color173 { background-color: #E7AB63; color: #000000;  }
.color174 { background-color: #4C6001; color: #000000;  }
.color175 { background-color: #9C6966; color: #000000;  }
.color176 { background-color: #64547B; color: #000000;  }
.color177 { background-color: #97979E; color: #000000;  }
.color178 { background-color: #006A66; color: #000000;  }
.color179 { background-color: #391406; color: #000000;  }
.color180 { background-color: #F4D749; color: #000000;  }
.color181 { background-color: #0045D2; color: #000000;  }
.color182 { background-color: #006C31; color: #000000;  }
.color183 { background-color: #DDB6D0; color: #000000;  }
.color184 { background-color: #7C6571; color: #000000;  }
.color185 { background-color: #9FB2A4; color: #000000;  }
.color186 { background-color: #00D891; color: #000000;  }
.color187 { background-color: #15A08A; color: #000000;  }
.color188 { background-color: #BC65E9; color: #000000;  }
.color189 { background-color: #FFFFFE; color: #000000;  }
.color190 { background-color: #C6DC99; color: #000000;  }
.color191 { background-color: #203B3C; color: #000000;  }
.color192 { background-color: #671190; color: #000000;  }
.color193 { background-color: #6B3A64; color: #000000;  }
.color194 { background-color: #F5E1FF; color: #000000;  }
.color195 { background-color: #FFA0F2; color: #000000;  }
.color196 { background-color: #CCAA35; color: #000000;  }
.color197 { background-color: #374527; color: #000000;  }
.color198 { background-color: #8BB400; color: #000000;  }
.color199 { background-color: #797868; color: #000000;  }
.color200 { background-color: #C6005A; color: #000000;  }
.color201 { background-color: #3B000A; color: #000000;  }
.color202 { background-color: #C86240; color: #000000;  }
.color203 { background-color: #29607C; color: #000000;  }
.color204 { background-color: #402334; color: #000000;  }
.color205 { background-color: #7D5A44; color: #000000;  }
.color206 { background-color: #CCB87C; color: #000000;  }
.color207 { background-color: #B88183; color: #000000;  }
.color208 { background-color: #AA5199; color: #000000;  }
.color209 { background-color: #B5D6C3; color: #000000;  }
.color210 { background-color: #A38469; color: #000000;  }
.color211 { background-color: #9F94F0; color: #000000;  }
.color212 { background-color: #A74571; color: #000000;  }
.color213 { background-color: #B894A6; color: #000000;  }
.color214 { background-color: #71BB8C; color: #000000;  }
.color215 { background-color: #00B433; color: #000000;  }
.color216 { background-color: #789EC9; color: #000000;  }
.color217 { background-color: #6D80BA; color: #000000;  }
.color218 { background-color: #953F00; color: #000000;  }
.color219 { background-color: #5EFF03; color: #000000;  }
.color220 { background-color: #E4FFFC; color: #000000;  }
.color221 { background-color: #1BE177; color: #000000;  }
.color222 { background-color: #BCB1E5; color: #000000;  }
.color223 { background-color: #76912F; color: #000000;  }
.color224 { background-color: #003109; color: #000000;  }
.color225 { background-color: #0060CD; color: #000000;  }
.color226 { background-color: #D20096; color: #000000;  }
.color227 { background-color: #895563; color: #000000;  }
.color228 { background-color: #29201D; color: #000000;  }
.color229 { background-color: #5B3213; color: #000000;  }
.color230 { background-color: #A76F42; color: #000000;  }
.color231 { background-color: #89412E; color: #000000;  }
.color232 { background-color: #1A3A2A; color: #000000;  }
.color233 { background-color: #494B5A; color: #000000;  }
.color234 { background-color: #A88C85; color: #000000;  }
.color235 { background-color: #F4ABAA; color: #000000;  }
.color236 { background-color: #A3F3AB; color: #000000;  }
.color237 { background-color: #00C6C8; color: #000000;  }
.color238 { background-color: #EA8B66; color: #000000;  }
.color239 { background-color: #958A9F; color: #000000;  }
.color240 { background-color: #BDC9D2; color: #000000;  }
.color241 { background-color: #9FA064; color: #000000;  }
.color242 { background-color: #BE4700; color: #000000;  }
.color243 { background-color: #658188; color: #000000;  }
.color244 { background-color: #83A485; color: #000000;  }
.color245 { background-color: #453C23; color: #000000;  }
.color246 { background-color: #47675D; color: #000000;  }
.color247 { background-color: #3A3F00; color: #000000;  }
.color248 { background-color: #061203; color: #000000;  }
.color249 { background-color: #DFFB71; color: #000000;  }
.color250 { background-color: #868E7E; color: #000000;  }
.color251 { background-color: #98D058; color: #000000;  }
.color252 { background-color: #6C8F7D; color: #000000;  }
.color253 { background-color: #D7BFC2; color: #000000;  }
.color254 { background-color: #3C3E6E; color: #000000;  }
.color255 { background-color: #D83D66; color: #000000;  }
.color256 { background-color: #2F5D9B; color: #000000;  }
.color257 { background-color: #6C5E46; color: #000000;  }
.color258 { background-color: #D25B88; color: #000000;  }
.color259 { background-color: #5B656C; color: #000000;  }
.color260 { background-color: #00B57F; color: #000000;  }
.color261 { background-color: #545C46; color: #000000;  }
.color262 { background-color: #866097; color: #000000;  }
.color263 { background-color: #365D25; color: #000000;  }
.color264 { background-color: #252F99; color: #000000;  }
.color265 { background-color: #00CCFF; color: #000000;  }
.color266 { background-color: #674E60; color: #000000;  }
.color267 { background-color: #FC009C; color: #000000;  }
.color268 { background-color: #92896B; color: #000000;  }

    </style>
    <body>
        <div class="container-fluid hdr-bg">
            <div class="container">
                <div class="row">
                    <div class="col-md-offset-1 col-md-10">
                        <h1 class="header">SDDL description</h1>
                    </div>
                </div>
            </div>
        </div>
        <div class="container body">
            <div class="row">
                <div class="col-md-offset-1 col-md-10">
                    <p>
                    A simple SDDL Parser which converts SDDL/Security descriptors/ACEs to a javascript object tree.
                    </p>
                    <p>
                    It's the SDDL equivolent of the awesome <a href="https://regex101.com">regex101</a>
                    </p>
                    <p>
                    It allows you to decode SDDL strings on a whim, no more looking up the <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa379567(v=vs.85).aspx">documentation</a> and figuring out whats what.
                    </p>
                    If you want the source, or to submit fixes/improvements, just go here: https://github.com/mountainstorm/js.sddl                    
                </div>
            </div>
            <div class="row">
                <div class="col-md-offset-1 col-md-10">
                    <h4>SDDL/SD/ACE string</h4>
                    <textarea class="form-control" id="sddl" placeholder="SDDL/SD/ACE"></textarea>
                </div>
            </div>
            <div class="row">
                <div class="col-md-offset-1 col-md-10">          
                    <h4>Details</h4>
                    <div id="details"></div>
                </div>
            </div>
        </div>     

        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="js/js.sddl.js"></script>
        <script type="text/javascript">
            var gNextColor = 0

            function displayNode(n, augment) {
                var details = n.details
                var color = ''
                if (n.details instanceof Array) {
                    details = ''
                    for (var i = 0; i < n.details.length; i++) {
                        details += displayNode(n.details[i], augment)
                    }
                } else if (n.details instanceof Object) {
                    details = displayNode(n.details, augment)
                } else {
                    // leaf node - so find and augment it
                    if (n.value.indexOf('0x') != 0) {
                        var i = augment.remaining.indexOf(n.value)
                        var filler = augment.remaining.substring(0, i)
                        var component = augment.remaining.substring(i, i+n.value.length)
                        augment.remaining = augment.remaining.substring(i+n.value.length)
                        // choose color
                        color = 'color' + gNextColor
                        gNextColor++               
                        augment.highlight += '<span>' + filler + '</span><span class="' + color + '">' + component + '</span>'
                    }
                }
                var retval = ''
                if ('title' in n) {
                    retval = '<table><tbody>' +
                        '<tr><th>' + n.title + '</th><td>' + n.value + '</td></tr>' +
                        '<tr><th></th><td>' + details + '</td></tr>' +
                        '</tbody></table>'
                } else {
                    retval = '<table><tbody>' +
                        '<tr><td class="' + color + '">' + n.value + '</td><td>' + details + '</td></tr>' +
                        '</tbody></table>'
                }
                return retval
            }

            function processSDDL(e) {
                var sddl = $(e.currentTarget).val()
                var $details = $('#details')
                $details.empty()

                gNextColor = 0
                var augment = {
                    remaining: sddl,
                    highlight: ''
                }
                var tree = sddlParseAny(sddl)
                var output = displayNode(tree, augment)
                $details.append('<div>' + augment.highlight + '</div>')
                $details.append(output)
            }

            $('#sddl').blur(processSDDL)
            $('#sddl').focusout(processSDDL)
            $('#sddl').keyup(processSDDL)
            $('#sddl').change(processSDDL)

            function getParameterByName(name, url) {
                if (!url) url = window.location.href
                name = name.replace(/[\[\]]/g, '\\$&')
                var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                    results = regex.exec(url)
                if (!results) return null
                if (!results[2]) return ''
                return decodeURIComponent(results[2].replace(/\+/g, ' '))
            }

            var q = getParameterByName('q')
            if (q && q.length) {
                $('#sddl').val(q)
            } else {
                // O:SYG:SYD:(A;;0xf03bf;;;SY)(A;;CCLO;;;LS)(A;;CCLO;;;NS)(A;;0xf03bf;;;BA)(A;;CC;;‌​;IU)
                //$('#sddl').val('O:AOG:DAD:ARP(A;;RPWPCCDCLCSWRCWDWOGA;;;S-1-0-0)')
                $('#sddl').val('O:AOG:DAD:(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCLCSWLORC;;;BO)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)')

            }
            $('#sddl').trigger('change')
        </script>
    </body>
</html>